(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[178],{6929:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/classes",function(){return t(3821)}])},3821:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return Classes}});var a=t(5893),l=t(7294),r=t(1163),i=t(6686),n=t(5951),c=t(7219);function Classes(){let e=(0,r.useRouter)(),[s,t]=(0,l.useState)([]),[d,o]=(0,l.useState)(!1),[h,u]=(0,l.useState)(null),[m,x]=(0,l.useState)(!1),[g,p]=(0,l.useState)(null),[b,j]=(0,l.useState)({course_id:"",teacher_id:"",room:"",schedule:"",status:"active"}),[_,f]=(0,l.useState)(null),[v,w]=(0,l.useState)([]),[N,k]=(0,l.useState)([]),[y,C]=(0,l.useState)(!1),[S,L]=(0,l.useState)(!1),[E,T]=(0,l.useState)(!1),[A,D]=(0,l.useState)(null),[H,M]=(0,l.useState)({course_id:"",teacher_id:"",room:"",start_time:"",end_time:"",registration_open_date:"",registration_close_date:"",course_start_date:"",course_end_date:"",status:"active"}),[O,P]=(0,l.useState)([]),[F,R]=(0,l.useState)(""),[z,J]=(0,l.useState)("all"),[X,K]=(0,l.useState)("course_name"),[Y,q]=(0,l.useState)("asc"),[I,U]=(0,l.useState)(1),[V,W]=(0,l.useState)(10),[$,B]=(0,l.useState)([]),[G,Q]=(0,l.useState)(""),[Z,ee]=(0,l.useState)({name:"",email:"",phone:""}),[es,et]=(0,l.useState)([]),[ea,el]=(0,l.useState)(""),[er,ei]=(0,l.useState)(""),[en,ec]=(0,l.useState)(""),[ed,eo]=(0,l.useState)(!1),[eh,eu]=(0,l.useState)(!1);async function load(){o(!0);try{let e=await (0,i.SH)("/api/classes");if(!e.ok)throw Error("Failed to load classes");let s=await e.json();t(s)}catch(e){u(e.message)}finally{o(!1)}}async function handleManage(s){u(null);try{let t=await (0,i.SH)("/api/classes/".concat(s.id,"/enrollments/sync"),{method:"POST"});if(!t.ok){let e={};try{e=await t.json()}catch(s){e={error:await t.text().catch(()=>t.statusText)}}throw Error(e.error||"Failed to sync enrollments (status ".concat(t.status,")"))}e.push("/class-students/".concat(s.id))}catch(e){console.error("handleManage error",e),u(e.message||"Kh\xf4ng thể đồng bộ dữ liệu lớp")}}async function openCreateModal(e){u(null);try{let e=await (0,i.SH)("/api/courses");e.ok&&P(await e.json());let s=await (0,i.SH)("/api/teachers");s.ok&&et(await s.json())}catch(e){}if(e){let s=e.schedule&&e.schedule.includes(" - ")?e.schedule.split(" - ")[0]:"",t=e.schedule&&e.schedule.includes(" - ")?e.schedule.split(" - ")[1]:"",fmt=e=>{if(!e)return"";if(/^\d{4}-\d{2}-\d{2}$/.test(e))return e;if("string"==typeof e&&e.includes("T"))return e.split("T")[0];try{let s=new Date(e);if(!isNaN(s.getTime()))return s.toISOString().slice(0,10)}catch(e){}return""};M({course_id:e.course_id||"",teacher_id:e.teacher_id||"",room:e.room||"",start_time:s,end_time:t,registration_open_date:fmt(e.registration_open_date),registration_close_date:fmt(e.registration_close_date),course_start_date:fmt(e.course_start_date),course_end_date:fmt(e.course_end_date),status:e.status||"active"}),D(e.id)}else M({course_id:"",teacher_id:"",room:"",start_time:"",end_time:"",registration_open_date:"",registration_close_date:"",course_start_date:"",course_end_date:"",status:"active"}),D(null);T(!0)}async function submitCreateClass(e){e.preventDefault(),u(null);try{let e;let s={...H};(H.start_time||H.end_time)&&(s.schedule="".concat(H.start_time||"").concat(H.start_time&&H.end_time?" - ":"").concat(H.end_time||"")),delete s.start_time,delete s.end_time,e=A?await (0,i.SH)("/api/classes/".concat(A),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}):await (0,i.SH)("/api/classes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});let t=await e.json();if(!e.ok)throw Error(t.error||JSON.stringify(t));T(!1),D(null),await load()}catch(e){u(e.message)}}async function loadClassDetails(e){u(null);try{let[s,t,a]=await Promise.all([(0,i.SH)("/api/classes/".concat(e.id)),(0,i.SH)("/api/classes/".concat(e.id,"/students")),(0,i.SH)("/api/classes/".concat(e.id,"/teachers"))]);if(!s.ok)throw Error("Failed to fetch class");if(!t.ok)throw Error("Failed to fetch enrolled students");if(!a.ok)throw Error("Failed to fetch class teachers");let l=await s.json(),r=await t.json(),n=await a.json();f(l),w(r),k(n),x(!0)}catch(e){u(e.message)}}async function openAddStudent(e){u(null);try{let e=await (0,i.SH)("/api/students");if(e.ok){let s=await e.json();B(s)}}catch(e){}Q(""),ee({name:"",email:"",phone:""}),ei(""),C(!0)}async function openAddTeacher(e){u(null);try{let e=await (0,i.SH)("/api/teachers");if(e.ok){let s=await e.json();et(s)}}catch(e){}el(""),ec(""),L(!0)}async function handleAddStudent(e){e.preventDefault(),u(null);try{let e=await (0,i.SH)("/api/classes/".concat(_.id,"/students"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(G?{student_id:G}:{student:Z})}),s=await e.json();if(!e.ok)throw Error(s.error||JSON.stringify(s));let t=await (0,i.SH)("/api/classes/".concat(_.id,"/students"));t.ok&&w(await t.json()),C(!1)}catch(e){u(e.message)}}async function removeStudentFromClass(e){if(confirm((0,n.t)("classes.confirm_remove_student","X\xe1c nhận gỡ học vi\xean khỏi lớp?")))try{let s=await (0,i.SH)("/api/classes/".concat(_.id,"/students/").concat(e),{method:"DELETE"});if(!s.ok){let e=await s.json().catch(()=>({}));throw Error(e.error||"Failed to remove")}let t=await (0,i.SH)("/api/classes/".concat(_.id,"/students"));t.ok&&w(await t.json())}catch(e){u(e.message)}}async function handleAddTeacher(e){e.preventDefault(),u(null);try{if(!ea)return u("Please select a teacher");let e=await (0,i.SH)("/api/classes/".concat(_.id,"/teachers"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({teacher_id:ea})}),s=await e.json();if(!e.ok)throw Error(s.error||JSON.stringify(s));let t=await (0,i.SH)("/api/classes/".concat(_.id,"/teachers"));t.ok&&k(await t.json()),L(!1)}catch(e){u(e.message)}}async function removeTeacherFromClass(e){if(confirm((0,n.t)("classes.confirm_remove_teacher","X\xe1c nhận gỡ gi\xe1o vi\xean khỏi lớp?")))try{let s=await (0,i.SH)("/api/classes/".concat(_.id,"/teachers/").concat(e),{method:"DELETE"});if(!s.ok){let e=await s.json().catch(()=>({}));throw Error(e.error||"Failed to remove")}let t=await (0,i.SH)("/api/classes/".concat(_.id,"/teachers"));t.ok&&k(await t.json())}catch(e){u(e.message)}}async function removeClass(e){if(confirm("X\xe1c nhận x\xf3a lớp học?"))try{let s=await (0,i.SH)("/api/classes/".concat(e),{method:"DELETE"}),t=await s.json();if(!s.ok)throw Error(t.error||JSON.stringify(t));await load()}catch(e){u(e.message)}}async function toggleClassStatus(e){let s="active"===e.status?"inactive":"active";try{o(!0);let a=await (0,i.SH)("/api/classes/".concat(e.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:s})}),l=await a.json().catch(()=>({}));if(!a.ok)throw Error(l.error||"Failed to update status");t(t=>t.map(t=>t.id===e.id?{...t,status:s}:t))}catch(e){console.error("toggle status error",e),u("Kh\xf4ng thể thay đổi trạng th\xe1i lớp")}finally{o(!1)}}return(0,l.useEffect)(()=>{load()},[]),(0,l.useEffect)(()=>{U(1)},[F,z,X,Y,V]),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("h1",{className:"text-2xl font-semibold inline-block bg-indigo-100 text-indigo-800 dark:bg-slate-700 dark:text-indigo-200 px-3 py-1 rounded",children:(0,n.t)("classes.title","Classes")}),(0,a.jsx)("div",{children:(0,a.jsxs)("button",{title:(0,n.t)("classes.new_title","New class"),onClick:()=>openCreateModal(),className:"flex items-center gap-2 px-3 py-2 bg-green-600 text-white rounded hover:opacity-90",children:[(0,a.jsx)(c.OvN,{})," ",(0,n.t)("classes.new","New")]})})]}),h&&(0,a.jsx)("div",{className:"mb-3 text-red-600",children:h}),(0,a.jsx)("div",{className:"bg-white dark:bg-slate-800 p-4 rounded",children:d?(0,a.jsx)("div",{children:(0,n.t)("loading","Đang tải...")}):(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-3 mb-3",children:[(0,a.jsx)("div",{className:"flex items-center gap-2 w-full md:w-1/2",children:(0,a.jsxs)("div",{className:"relative w-full",children:[(0,a.jsx)("input",{placeholder:(0,n.t)("classes.search_placeholder","T\xecm kiếm lớp, kh\xf3a học, gi\xe1o vi\xean..."),value:F,onChange:e=>R(e.target.value),className:"p-2 pr-8 border rounded w-full bg-white dark:bg-slate-700 dark:text-slate-100 dark:border-slate-600"}),F&&(0,a.jsx)("button",{onClick:()=>R(""),className:"absolute right-2 top-1/2 -translate-y-1/2 text-slate-500 hover:text-slate-700",children:"\xd7"})]})}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("select",{value:z,onChange:e=>J(e.target.value),className:"p-2 border rounded bg-white dark:bg-slate-700 dark:text-slate-100 dark:border-slate-600",children:[(0,a.jsx)("option",{value:"all",children:(0,n.t)("classes.filter_all","All statuses")}),(0,a.jsx)("option",{value:"active",children:(0,n.t)("classes.filter_active","Active")}),(0,a.jsx)("option",{value:"inactive",children:(0,n.t)("classes.filter_inactive","Inactive")})]}),(0,a.jsxs)("select",{value:V,onChange:e=>W(Number(e.target.value)),className:"p-2 border rounded bg-white dark:bg-slate-700 dark:text-slate-100 dark:border-slate-600",children:[(0,a.jsx)("option",{value:5,children:"5 / page"}),(0,a.jsx)("option",{value:10,children:"10 / page"}),(0,a.jsx)("option",{value:20,children:"20 / page"})]})]})]}),(0,a.jsxs)("table",{className:"min-w-full table-auto",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"text-left",children:[(0,a.jsx)("th",{className:"p-2",children:(0,n.t)("classes.col_no","No.")}),(0,a.jsxs)("th",{className:"p-2 cursor-pointer",onClick:()=>{"course_name"===X?q(e=>"asc"===e?"desc":"asc"):(K("course_name"),q("asc"))},children:[(0,n.t)("classes.col_course","Course")," ","course_name"===X?"asc"===Y?"↑":"↓":""]}),(0,a.jsx)("th",{className:"p-2",children:(0,n.t)("classes.col_students","Students")}),(0,a.jsx)("th",{className:"p-2",children:(0,n.t)("classes.col_reserved","Reserved")}),(0,a.jsx)("th",{children:(0,n.t)("classes.col_teachers","Teacher(s)")}),(0,a.jsx)("th",{children:(0,n.t)("classes.col_room","Room")}),(0,a.jsx)("th",{children:(0,n.t)("classes.col_schedule","Schedule")}),(0,a.jsx)("th",{children:(0,n.t)("classes.col_reg_open","Reg. Open")}),(0,a.jsx)("th",{children:(0,n.t)("classes.col_start","Start")}),(0,a.jsx)("th",{children:(0,n.t)("classes.col_status","Status")}),(0,a.jsx)("th",{children:(0,n.t)("classes.col_actions","Actions")})]})}),(0,a.jsx)("tbody",{children:(()=>{let e=(F||"").toLowerCase().trim(),t=Array.isArray(s)?s.slice():[];"all"!==z&&(t=t.filter(e=>(e.status||"").toLowerCase()===z)),e&&(t=t.filter(s=>{let t=(s.course_name||s.course||"").toString().toLowerCase(),a=(s.teacher_name||s.teacher||"").toString().toLowerCase(),l=(s.room||"").toString().toLowerCase();return t.includes(e)||a.includes(e)||l.includes(e)})),t.sort((e,s)=>{let t=(e[X]||"").toString().toLowerCase(),a=(s[X]||"").toString().toLowerCase();return t<a?"asc"===Y?-1:1:t>a?"asc"===Y?1:-1:0});let l=t.length,r=Math.max(1,Math.ceil(l/V)),i=(Math.min(Math.max(1,I),r)-1)*V,d=t.slice(i,i+V);return d.map((e,s)=>(0,a.jsxs)("tr",{className:"border-t",children:[(0,a.jsx)("td",{className:"p-2",children:i+s+1}),(0,a.jsx)("td",{className:"p-2",children:e.course_name||(e.course_id?e.course_id:e.course)}),(0,a.jsx)("td",{className:"p-2",children:void 0!==e.student_count?e.student_count:0}),(0,a.jsx)("td",{className:"p-2",children:void 0!==e.reserved_count?e.reserved_count:0}),(0,a.jsx)("td",{children:e.teacher_name||(e.teacher_id?e.teacher_id:e.teacher)}),(0,a.jsx)("td",{children:e.room}),(0,a.jsx)("td",{children:e.schedule}),(0,a.jsx)("td",{className:"p-2",children:e.registration_open_date?new Date(e.registration_open_date).toLocaleDateString():"—"}),(0,a.jsx)("td",{className:"p-2",children:e.course_start_date?new Date(e.course_start_date).toLocaleDateString():"—"}),(0,a.jsx)("td",{className:"p-2",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)("label",{className:"inline-flex items-center cursor-pointer",children:[(0,a.jsx)("input",{type:"checkbox",className:"sr-only",checked:"active"===e.status,onChange:()=>toggleClassStatus(e)}),(0,a.jsx)("div",{className:"w-10 h-6 flex items-center bg-gray-300 rounded-full p-1 transition-colors ".concat("active"===e.status?"bg-green-500":"bg-gray-300"),children:(0,a.jsx)("div",{className:"bg-white w-4 h-4 rounded-full shadow-md transform transition-transform ".concat("active"===e.status?"translate-x-4":"")})})]}),(0,a.jsx)("span",{className:"text-sm",children:(0,n.t)("classes.status_".concat(e.status),e.status)})]})}),(0,a.jsxs)("td",{className:"p-2",children:[(0,a.jsx)("button",{title:(0,n.t)("classes.action_manage","Manage"),onClick:()=>handleManage(e),className:"mr-2 p-2 bg-sky-500 text-white rounded hover:opacity-90",children:(0,a.jsx)(c.WY8,{})}),(0,a.jsx)("button",{title:(0,n.t)("classes.action_view","View"),onClick:()=>loadClassDetails(e),className:"mr-2 p-2 bg-blue-500 text-white rounded hover:opacity-90",children:(0,a.jsx)(c.rDJ,{})}),(0,a.jsx)("button",{title:(0,n.t)("classes.action_edit","Edit"),onClick:()=>openCreateModal(e),className:"mr-2 p-2 bg-yellow-500 text-white rounded hover:opacity-90",children:(0,a.jsx)(c.Nte,{})}),(0,a.jsx)("button",{title:(0,n.t)("classes.action_delete","Delete"),onClick:()=>removeClass(e.id),className:"p-2 bg-red-500 text-white rounded hover:opacity-90",children:(0,a.jsx)(c.Ybf,{})})]})]},e.id))})()})]}),(()=>{let e=(F||"").toLowerCase().trim(),t=Array.isArray(s)?s.slice():[];"all"!==z&&(t=t.filter(e=>(e.status||"").toLowerCase()===z)),e&&(t=t.filter(s=>{let t=(s.course_name||s.course||"").toString().toLowerCase(),a=(s.teacher_name||s.teacher||"").toString().toLowerCase(),l=(s.room||"").toString().toLowerCase();return t.includes(e)||a.includes(e)||l.includes(e)}));let l=t.length,r=Math.max(1,Math.ceil(l/V)),i=Math.min(Math.max(1,I),r);return(0,a.jsxs)("div",{className:"flex items-center justify-between mt-3",children:[(0,a.jsxs)("div",{className:"text-sm",children:[(0,n.t)("classes.showing_prefix","Hiển thị")," ",(i-1)*V+1," - ",Math.min(i*V,l)," ",(0,n.t)("classes.showing_of","của")," ",l]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("button",{onClick:()=>U(e=>Math.max(1,e-1)),disabled:1===i,className:"px-2 py-1 border rounded disabled:opacity-50",children:(0,n.t)("pagination.prev","Prev")}),(0,a.jsx)("div",{className:"flex items-center gap-1",children:Array.from({length:r}).map((e,s)=>(0,a.jsx)("button",{onClick:()=>U(s+1),className:"px-2 py-1 border rounded ".concat(i===s+1?"bg-slate-200":""),children:s+1},s))}),(0,a.jsx)("button",{onClick:()=>U(e=>Math.min(r,e+1)),disabled:i===r,className:"px-2 py-1 border rounded disabled:opacity-50",children:(0,n.t)("pagination.next","Next")})]})]})})()]})}),m&&_&&(0,a.jsxs)("div",{className:"fixed inset-0 z-40 flex items-center justify-center",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-black opacity-40",onClick:()=>x(!1)}),(0,a.jsxs)("div",{className:"relative bg-white dark:bg-slate-800 rounded-lg p-6 w-full max-w-3xl z-50",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold mb-3 inline-block bg-indigo-100 text-indigo-800 dark:bg-slate-700 dark:text-indigo-200 px-3 py-1 rounded",children:(0,n.t)("classes.details_title","Class Details")}),(0,a.jsxs)("div",{className:"mb-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("strong",{children:[(0,n.t)("classes.field_course_label","Course"),":"]})," ",_.course_name||_.course_id]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("strong",{children:[(0,n.t)("classes.field_teachers_label","Teacher(s)"),":"]})," ",Array.isArray(N)&&N.length?N.map(e=>e.name).join(", "):"—"]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("strong",{children:[(0,n.t)("classes.field_room_label","Room"),":"]})," ",_.room]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("strong",{children:[(0,n.t)("classes.field_schedule_label","Schedule"),":"]})," ",_.schedule]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("strong",{children:[(0,n.t)("classes.field_reg_open_label","Registration open"),":"]})," ",_.registration_open_date?new Date(_.registration_open_date).toLocaleDateString():"—"]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("strong",{children:[(0,n.t)("classes.field_reg_close_label","Registration close"),":"]})," ",_.registration_close_date?new Date(_.registration_close_date).toLocaleDateString():"—"]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("strong",{children:[(0,n.t)("classes.field_start_label","Course start"),":"]})," ",_.course_start_date?new Date(_.course_start_date).toLocaleDateString():"—"]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("strong",{children:[(0,n.t)("classes.field_end_label","Course end"),":"]})," ",_.course_end_date?new Date(_.course_end_date).toLocaleDateString():"—"]})]}),(0,a.jsxs)("div",{className:"mb-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h3",{className:"font-semibold",children:(0,n.t)("classes.enrolled_students","Enrolled students")}),(0,a.jsx)("div",{children:(0,a.jsx)("button",{title:(0,n.t)("classes.add_student","Add student"),onClick:()=>openAddStudent(_),className:"p-2 bg-green-600 text-white rounded hover:opacity-90",children:(0,a.jsx)(c.zy7,{})})})]}),(0,a.jsxs)("table",{className:"min-w-full table-auto mt-2",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"text-left",children:[(0,a.jsx)("th",{className:"p-2",children:(0,n.t)("classes.col_no","No.")}),(0,a.jsx)("th",{children:(0,n.t)("classes.col_name","Name")}),(0,a.jsx)("th",{children:(0,n.t)("classes.col_phone","Phone")}),(0,a.jsx)("th",{children:(0,n.t)("classes.col_email","Email")}),(0,a.jsx)("th",{children:(0,n.t)("classes.col_actions","Actions")})]})}),(0,a.jsx)("tbody",{children:v.map((e,s)=>(0,a.jsxs)("tr",{className:"border-t",children:[(0,a.jsx)("td",{className:"p-2",children:s+1}),(0,a.jsx)("td",{className:"p-2",children:e.name}),(0,a.jsx)("td",{children:e.phone}),(0,a.jsx)("td",{children:e.email}),(0,a.jsx)("td",{className:"p-2",children:(0,a.jsx)("button",{title:(0,n.t)("classes.remove_student","Remove student"),onClick:()=>removeStudentFromClass(e.student_id),className:"p-2 bg-red-500 text-white rounded hover:opacity-90",children:(0,a.jsx)(c.Ybf,{})})})]},e.student_id))})]})]}),(0,a.jsxs)("div",{className:"mb-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h3",{className:"font-semibold",children:(0,n.t)("classes.assigned_teachers","Assigned teachers")}),(0,a.jsx)("div",{children:(0,a.jsx)("button",{title:(0,n.t)("classes.add_teacher","Add teacher"),onClick:()=>openAddTeacher(_),className:"p-2 bg-indigo-600 text-white rounded hover:opacity-90",children:(0,a.jsx)(c.tMu,{})})})]}),(0,a.jsxs)("table",{className:"min-w-full table-auto mt-2",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"text-left",children:[(0,a.jsx)("th",{className:"p-2",children:(0,n.t)("classes.col_no","No.")}),(0,a.jsx)("th",{children:(0,n.t)("classes.col_name","Name")}),(0,a.jsx)("th",{children:(0,n.t)("classes.col_phone","Phone")}),(0,a.jsx)("th",{children:(0,n.t)("classes.col_email","Email")}),(0,a.jsx)("th",{children:(0,n.t)("classes.col_actions","Actions")})]})}),(0,a.jsx)("tbody",{children:N.map((e,s)=>(0,a.jsxs)("tr",{className:"border-t",children:[(0,a.jsx)("td",{className:"p-2",children:s+1}),(0,a.jsx)("td",{className:"p-2",children:e.name}),(0,a.jsx)("td",{children:e.phone}),(0,a.jsx)("td",{children:e.email}),(0,a.jsx)("td",{className:"p-2",children:(0,a.jsx)("button",{title:e("classes.remove_teacher","Remove teacher"),onClick:()=>removeTeacherFromClass(e.teacher_id),className:"p-2 bg-red-500 text-white rounded hover:opacity-90",children:(0,a.jsx)(c.Ybf,{})})})]},e.teacher_id))})]})]}),(0,a.jsx)("div",{className:"flex justify-end gap-2 mt-4",children:(0,a.jsx)("button",{onClick:()=>x(!1),className:"px-3 py-2 border rounded",children:(0,n.t)("actions.close","Close")})})]})]}),E&&(0,a.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-black opacity-40",onClick:()=>{T(!1),D(null)}}),(0,a.jsxs)("div",{className:"relative bg-white dark:bg-slate-800 rounded-lg p-6 w-full max-w-lg z-60",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-3",children:A?(0,n.t)("classes.edit_title","Edit Class"):(0,n.t)("classes.create_title","Create New Class")}),(0,a.jsxs)("form",{onSubmit:submitCreateClass,className:"grid grid-cols-1 gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:(0,n.t)("classes.field_course","Course")}),(0,a.jsxs)("select",{value:H.course_id,onChange:e=>M(s=>({...s,course_id:e.target.value})),className:"p-2 border rounded w-full bg-white dark:bg-slate-700 dark:text-slate-100 dark:border-slate-600",children:[(0,a.jsx)("option",{value:"",children:"-- choose course --"}),O.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:(0,n.t)("classes.field_teacher","Primary teacher (optional)")}),(0,a.jsxs)("select",{value:H.teacher_id,onChange:e=>M(s=>({...s,teacher_id:e.target.value})),className:"p-2 border rounded w-full bg-white dark:bg-slate-700 dark:text-slate-100 dark:border-slate-600",children:[(0,a.jsx)("option",{value:"",children:"-- none --"}),es.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:(0,n.t)("classes.field_room","Room")}),(0,a.jsx)("input",{value:H.room,onChange:e=>M(s=>({...s,room:e.target.value})),className:"p-2 border rounded w-full bg-white dark:bg-slate-700 dark:text-slate-100 dark:border-slate-600"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:(0,n.t)("classes.field_start_time","Start time")}),(0,a.jsx)("input",{type:"time",value:H.start_time,onChange:e=>M(s=>({...s,start_time:e.target.value})),className:"p-2 border rounded w-full bg-white dark:bg-slate-700 dark:text-slate-100 dark:border-slate-600"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:(0,n.t)("classes.field_end_time","End time")}),(0,a.jsx)("input",{type:"time",value:H.end_time,onChange:e=>M(s=>({...s,end_time:e.target.value})),className:"p-2 border rounded w-full bg-white dark:bg-slate-700 dark:text-slate-100 dark:border-slate-600"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:(0,n.t)("classes.field_reg_open","Registration open")}),(0,a.jsx)("input",{type:"date",value:H.registration_open_date,onChange:e=>M(s=>({...s,registration_open_date:e.target.value})),className:"p-2 border rounded w-full bg-white dark:bg-slate-700 dark:text-slate-100 dark:border-slate-600"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:(0,n.t)("classes.field_reg_close","Registration close")}),(0,a.jsx)("input",{type:"date",value:H.registration_close_date,onChange:e=>M(s=>({...s,registration_close_date:e.target.value})),className:"p-2 border rounded w-full bg-white dark:bg-slate-700 dark:text-slate-100 dark:border-slate-600"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:(0,n.t)("classes.field_course_start","Course start")}),(0,a.jsx)("input",{type:"date",value:H.course_start_date,onChange:e=>M(s=>({...s,course_start_date:e.target.value})),className:"p-2 border rounded w-full bg-white dark:bg-slate-700 dark:text-slate-100 dark:border-slate-600"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:(0,n.t)("classes.field_course_end","Course end")}),(0,a.jsx)("input",{type:"date",value:H.course_end_date,onChange:e=>M(s=>({...s,course_end_date:e.target.value})),className:"p-2 border rounded w-full bg-white dark:bg-slate-700 dark:text-slate-100 dark:border-slate-600"})]})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2 mt-2",children:[(0,a.jsx)("button",{type:"button",onClick:()=>{T(!1),D(null)},className:"px-3 py-2 border rounded",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",className:"px-3 py-2 bg-green-600 text-white rounded",children:"Create"})]})]})]})]}),y&&(0,a.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-black opacity-40",onClick:()=>C(!1)}),(0,a.jsxs)("div",{className:"relative bg-white dark:bg-slate-800 rounded-lg p-6 w-full max-w-2xl z-60",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-3",children:"Add student to class"}),(0,a.jsxs)("form",{onSubmit:handleAddStudent,className:"grid grid-cols-1 gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Select existing student"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{placeholder:(0,n.t)("classes.search_student_placeholder","T\xecm hoặc chọn học vi\xean..."),value:er,onChange:e=>{ei(e.target.value),eo(!0)},onFocus:()=>eo(!0),className:"p-2 pr-8 border rounded w-full bg-white dark:bg-slate-700 dark:text-slate-100 dark:border-slate-600"}),er&&(0,a.jsx)("button",{type:"button",onClick:()=>ei(""),className:"absolute right-2 top-1/2 -translate-y-1/2 text-slate-500 hover:text-slate-700",children:"\xd7"}),(0,a.jsxs)("div",{className:"absolute left-0 right-0 mt-1 bg-white dark:bg-slate-800 border rounded max-h-48 overflow-auto z-30 ".concat(ed?"":"hidden"),children:[$.filter(e=>!v.some(s=>s.student_id===e.id)).filter(e=>(e.name||"").toLowerCase().includes(er.toLowerCase())||(e.email||"").toLowerCase().includes(er.toLowerCase())||(e.phone||"").toLowerCase().includes(er.toLowerCase())).map(e=>(0,a.jsxs)("div",{onMouseDown:()=>{Q(String(e.id)),ei(e.name||""),eo(!1)},className:"px-3 py-2 hover:bg-gray-100 dark:hover:bg-slate-700 cursor-pointer",children:[(0,a.jsx)("div",{className:"font-medium",children:e.name}),(0,a.jsx)("div",{className:"text-sm text-slate-500",children:e.email||e.phone})]},e.id)),0===$.filter(e=>!v.some(s=>s.student_id===e.id)).filter(e=>(e.name||"").toLowerCase().includes(er.toLowerCase())||(e.email||"").toLowerCase().includes(er.toLowerCase())||(e.phone||"").toLowerCase().includes(er.toLowerCase())).length&&(0,a.jsx)("div",{className:"p-2 text-sm text-slate-500",children:(0,n.t)("classes.no_results","Kh\xf4ng c\xf3 kết quả")})]})]})]}),(0,a.jsxs)("div",{className:"pt-2",children:[(0,a.jsx)("div",{className:"text-sm font-medium mb-1",children:(0,n.t)("classes.or_create_new_student","Hoặc tạo học vi\xean mới")}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2",children:[(0,a.jsx)("input",{placeholder:(0,n.t)("classes.input_name","Name"),value:Z.name,onChange:e=>ee(s=>({...s,name:e.target.value})),className:"p-2 border rounded bg-white dark:bg-slate-700 dark:text-slate-100 dark:border-slate-600"}),(0,a.jsx)("input",{placeholder:(0,n.t)("classes.input_email","Email"),value:Z.email,onChange:e=>ee(s=>({...s,email:e.target.value})),className:"p-2 border rounded bg-white dark:bg-slate-700 dark:text-slate-100 dark:border-slate-600"}),(0,a.jsx)("input",{placeholder:(0,n.t)("classes.input_phone","Phone"),value:Z.phone,onChange:e=>ee(s=>({...s,phone:e.target.value})),className:"p-2 border rounded bg-white dark:bg-slate-700 dark:text-slate-100 dark:border-slate-600"})]})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2 mt-4",children:[(0,a.jsx)("button",{type:"button",onClick:()=>C(!1),className:"px-3 py-2 border rounded",children:(0,n.t)("actions.cancel","Cancel")}),(0,a.jsx)("button",{type:"submit",className:"px-3 py-2 bg-green-600 text-white rounded",children:(0,n.t)("classes.add","Add")})]})]})]})]}),S&&(0,a.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-black opacity-40",onClick:()=>L(!1)}),(0,a.jsxs)("div",{className:"relative bg-white dark:bg-slate-800 rounded-lg p-6 w-full max-w-md z-60",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-3",children:"Assign teacher to class"}),(0,a.jsxs)("form",{onSubmit:handleAddTeacher,className:"grid grid-cols-1 gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Select existing teacher"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{placeholder:(0,n.t)("classes.search_teacher_placeholder","T\xecm hoặc chọn gi\xe1o vi\xean..."),value:en,onChange:e=>{ec(e.target.value),eu(!0)},onFocus:()=>eu(!0),className:"p-2 pr-8 border rounded w-full bg-white dark:bg-slate-700 dark:text-slate-100 dark:border-slate-600"}),en&&(0,a.jsx)("button",{type:"button",onClick:()=>ec(""),className:"absolute right-2 top-1/2 -translate-y-1/2 text-slate-500 hover:text-slate-700",children:"\xd7"}),(0,a.jsxs)("div",{className:"absolute left-0 right-0 mt-1 bg-white dark:bg-slate-800 border rounded max-h-48 overflow-auto z-30 ".concat(eh?"":"hidden"),children:[es.filter(e=>!N.some(s=>s.teacher_id===e.id)).filter(e=>(e.name||"").toLowerCase().includes(en.toLowerCase())||(e.email||"").toLowerCase().includes(en.toLowerCase())||(e.phone||"").toLowerCase().includes(en.toLowerCase())).map(e=>(0,a.jsxs)("div",{onMouseDown:()=>{el(String(e.id)),ec(e.name||""),eu(!1)},className:"px-3 py-2 hover:bg-gray-100 dark:hover:bg-slate-700 cursor-pointer",children:[(0,a.jsx)("div",{className:"font-medium",children:e.name}),(0,a.jsx)("div",{className:"text-sm text-slate-500",children:e.email||e.phone})]},e.id)),0===es.filter(e=>!N.some(s=>s.teacher_id===e.id)).filter(e=>(e.name||"").toLowerCase().includes(en.toLowerCase())||(e.email||"").toLowerCase().includes(en.toLowerCase())||(e.phone||"").toLowerCase().includes(en.toLowerCase())).length&&(0,a.jsx)("div",{className:"p-2 text-sm text-slate-500",children:(0,n.t)("classes.no_results","Kh\xf4ng c\xf3 kết quả")})]})]})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2 mt-4",children:[(0,a.jsx)("button",{type:"button",onClick:()=>L(!1),className:"px-3 py-2 border rounded",children:(0,n.t)("actions.cancel","Cancel")}),(0,a.jsx)("button",{type:"submit",className:"px-3 py-2 bg-indigo-600 text-white rounded",children:(0,n.t)("classes.assign","Assign")})]})]})]})]})]})}}},function(e){e.O(0,[774,888,179],function(){return e(e.s=6929)}),_N_E=e.O()}]);