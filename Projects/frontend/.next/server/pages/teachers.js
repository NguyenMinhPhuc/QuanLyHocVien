"use strict";(()=>{var e={};e.id=367,e.ids=[367,888,660],e.modules={5773:(e,t,a)=>{a.r(t),a.d(t,{config:()=>g,default:()=>m,getServerSideProps:()=>j,getStaticPaths:()=>p,getStaticProps:()=>x,reportWebVitals:()=>b,routeModule:()=>w,unstable_getServerProps:()=>N,unstable_getServerSideProps:()=>y,unstable_getStaticParams:()=>S,unstable_getStaticPaths:()=>f,unstable_getStaticProps:()=>v});var s={};a.r(s),a.d(s,{default:()=>Teachers});var r=a(7093),l=a(5244),i=a(1323),n=a(9209),c=a.n(n),d=a(181),o=a(997),u=a(6689),h=a(6686);function Teachers(){let[e,t]=(0,u.useState)([]),[a,s]=(0,u.useState)(!1),[r,l]=(0,u.useState)(null),[i,n]=(0,u.useState)(!1),[c,d]=(0,u.useState)(null),[m,x]=(0,u.useState)({name:"",phone:"",email:"",status:"active"}),[p,j]=(0,u.useState)(""),[g,b]=(0,u.useState)("name"),[v,f]=(0,u.useState)("asc"),[S,N]=(0,u.useState)(""),[y,w]=(0,u.useState)(1),[P,C]=(0,u.useState)(10),[k,_]=(0,u.useState)([]);async function load(){s(!0);try{let e=await (0,h.S)("/api/teachers");if(!e.ok)throw Error("Failed to load");let a=await e.json();t(a)}catch(e){l(e.message)}finally{s(!1)}}(0,u.useEffect)(()=>{load()},[]),(0,u.useEffect)(()=>{w(1),_([])},[p,g,v,S,P]);let filteredSorted=()=>{let t=Array.isArray(e)?e.slice():[];if(p){let e=p.toLowerCase();t=t.filter(t=>(t.name||"").toLowerCase().includes(e)||(t.email||"").toLowerCase().includes(e)||(t.phone||"").toLowerCase().includes(e))}return S&&(t=t.filter(e=>(e.status||"")===S)),t.sort((e,t)=>{let a=((e[g]||"")+"").toString().toLowerCase(),s=((t[g]||"")+"").toString().toLowerCase();return a<s?"asc"===v?-1:1:a>s?"asc"===v?1:-1:0}),t},currentPageItems=()=>{let e=filteredSorted(),t=(y-1)*P;return e.slice(t,t+P)},totalPages=()=>Math.max(1,Math.ceil(filteredSorted().length/P));async function handleSave(e){e.preventDefault(),l(null);try{let e;let t={name:m.name,phone:m.phone,email:m.email,status:m.status};e=c?await (0,h.S)(`/api/teachers/${c.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}):await (0,h.S)("/api/teachers",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});let a=await e.json();if(!e.ok)throw Error(a.error||JSON.stringify(a));await load(),n(!1)}catch(e){l(e.message)}}async function editTeacher(e){l(null);try{let t=await (0,h.S)(`/api/teachers/${e.id}`);if(!t.ok){let e=await t.json().catch(()=>({}));throw Error(e.error||"Failed to fetch teacher")}let a=await t.json();d(a),x({name:a.name||"",phone:a.phone||"",email:a.email||"",status:a.status||"active"}),n(!0)}catch(e){l(e.message)}}async function removeTeacher(e){if(confirm("X\xe1c nhận x\xf3a gi\xe1o vi\xean?"))try{let t=await (0,h.S)(`/api/teachers/${e}`,{method:"DELETE"}),a=await t.json();if(!t.ok)throw Error(a.error||JSON.stringify(a));await load()}catch(e){l(e.message)}}return(0,o.jsxs)("div",{children:[(0,o.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[o.jsx("h1",{className:"text-2xl font-semibold",children:"Teachers"}),o.jsx("div",{children:o.jsx("button",{onClick:function(){d(null),x({name:"",phone:"",email:"",status:"active"}),n(!0)},className:"px-3 py-1 bg-blue-600 text-white rounded",children:"Add teacher"})})]}),r&&o.jsx("div",{className:"mb-3 text-red-600",children:r}),i&&(0,o.jsxs)("div",{className:"fixed inset-0 z-40 flex items-center justify-center",children:[o.jsx("div",{className:"absolute inset-0 bg-black opacity-40",onClick:()=>n(!1)}),(0,o.jsxs)("div",{className:"relative bg-white dark:bg-slate-800 rounded-lg p-6 w-full max-w-2xl z-50",children:[o.jsx("h2",{className:"text-lg font-semibold mb-3",children:c?"Edit teacher":"Add teacher"}),(0,o.jsxs)("form",{onSubmit:handleSave,className:"grid grid-cols-1 gap-3",children:[(0,o.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,o.jsxs)("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Name"}),o.jsx("input",{value:m.name,onChange:e=>x(t=>({...t,name:e.target.value})),required:!0,className:"p-2 border rounded bg-transparent w-full"})]}),(0,o.jsxs)("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Phone"}),o.jsx("input",{value:m.phone,onChange:e=>x(t=>({...t,phone:e.target.value})),className:"p-2 border rounded bg-transparent w-full"})]}),(0,o.jsxs)("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Email"}),o.jsx("input",{type:"email",value:m.email,onChange:e=>x(t=>({...t,email:e.target.value})),className:"p-2 border rounded bg-transparent w-full"})]}),(0,o.jsxs)("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Status"}),(0,o.jsxs)("select",{value:m.status,onChange:e=>x(t=>({...t,status:e.target.value})),className:"p-2 border rounded bg-transparent w-full",children:[o.jsx("option",{value:"active",children:"active"}),o.jsx("option",{value:"inactive",children:"inactive"})]})]})]}),(0,o.jsxs)("div",{className:"flex justify-end gap-2 mt-4",children:[o.jsx("button",{type:"button",onClick:()=>n(!1),className:"px-3 py-2 border rounded",children:"Cancel"}),o.jsx("button",{type:"submit",className:"px-3 py-2 bg-green-600 text-white rounded",children:c?"Update":"Create"})]})]})]})]}),o.jsx("div",{className:"bg-white dark:bg-slate-800 p-4 rounded",children:a?o.jsx("div",{children:"Loading..."}):(0,o.jsxs)("div",{children:[(0,o.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-2 mb-3",children:[(0,o.jsxs)("div",{className:"flex items-center gap-2",children:[o.jsx("input",{value:p,onChange:e=>j(e.target.value),placeholder:"Search name/email/phone",className:"p-2 border rounded w-64"}),(0,o.jsxs)("select",{value:g,onChange:e=>b(e.target.value),className:"p-2 border rounded",children:[o.jsx("option",{value:"name",children:"Sort by Name"}),o.jsx("option",{value:"email",children:"Sort by Email"}),o.jsx("option",{value:"phone",children:"Sort by Phone"})]}),(0,o.jsxs)("select",{value:v,onChange:e=>f(e.target.value),className:"p-2 border rounded",children:[o.jsx("option",{value:"asc",children:"Asc"}),o.jsx("option",{value:"desc",children:"Desc"})]}),(0,o.jsxs)("select",{value:S,onChange:e=>N(e.target.value),className:"p-2 border rounded",children:[o.jsx("option",{value:"",children:"All statuses"}),o.jsx("option",{value:"active",children:"active"}),o.jsx("option",{value:"inactive",children:"inactive"}),o.jsx("option",{value:"disabled",children:"disabled"})]})]}),(0,o.jsxs)("div",{className:"flex items-center gap-2",children:[o.jsx("label",{className:"text-sm",children:"Rows:"}),(0,o.jsxs)("select",{value:P,onChange:e=>C(parseInt(e.target.value,10)),className:"p-2 border rounded",children:[o.jsx("option",{value:"5",children:"5"}),o.jsx("option",{value:"10",children:"10"}),o.jsx("option",{value:"25",children:"25"}),o.jsx("option",{value:"50",children:"50"})]})]})]}),(0,o.jsxs)("table",{className:"min-w-full table-auto",children:[o.jsx("thead",{children:(0,o.jsxs)("tr",{className:"text-left",children:[o.jsx("th",{className:"p-2",children:o.jsx("input",{type:"checkbox",onChange:e=>(function(e){let t=currentPageItems().map(e=>e.id);e?_(e=>Array.from(new Set([...e,...t]))):_(e=>e.filter(e=>!t.includes(e)))})(e.target.checked),checked:currentPageItems().every(e=>k.includes(e.id))&&currentPageItems().length>0})}),o.jsx("th",{className:"p-2",children:"No."}),o.jsx("th",{className:"p-2",children:"Name"}),o.jsx("th",{children:"Phone"}),o.jsx("th",{children:"Email"}),o.jsx("th",{children:"Status"}),o.jsx("th",{children:"Actions"})]})}),o.jsx("tbody",{children:currentPageItems().map((e,t)=>(0,o.jsxs)("tr",{className:"border-t",children:[o.jsx("td",{className:"p-2",children:o.jsx("input",{type:"checkbox",checked:k.includes(e.id),onChange:t=>_(a=>t.target.checked?Array.from(new Set([...a,e.id])):a.filter(t=>t!==e.id))})}),o.jsx("td",{className:"p-2",children:(y-1)*P+t+1}),o.jsx("td",{className:"p-2",children:e.name}),o.jsx("td",{children:e.phone}),o.jsx("td",{children:e.email}),o.jsx("td",{className:"p-2",children:(0,o.jsxs)("select",{value:e.status||"active",onChange:async t=>{let a=t.target.value;try{let t=await (0,h.S)(`/api/teachers/${e.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:a})}),s=await t.json().catch(()=>({}));if(!t.ok)throw Error(s.error||"Failed to update status");await load()}catch(e){l(e.message)}},className:"p-1 border rounded bg-transparent",children:[o.jsx("option",{value:"active",children:"active"}),o.jsx("option",{value:"inactive",children:"inactive"}),o.jsx("option",{value:"disabled",children:"disabled"})]})}),(0,o.jsxs)("td",{className:"p-2",children:[o.jsx("button",{onClick:()=>editTeacher(e),className:"mr-2 px-2 py-1 bg-yellow-400 rounded",children:"Edit"}),o.jsx("button",{onClick:()=>removeTeacher(e.id),className:"px-2 py-1 bg-red-500 text-white rounded",children:"Delete"})]})]},e.id))})]}),(0,o.jsxs)("div",{className:"flex items-center justify-between mt-3",children:[(0,o.jsxs)("div",{children:[o.jsx("button",{disabled:y<=1,onClick:()=>w(e=>Math.max(1,e-1)),className:"px-2 py-1 border rounded mr-2",children:"Prev"}),o.jsx("button",{disabled:y>=totalPages(),onClick:()=>w(e=>Math.min(totalPages(),e+1)),className:"px-2 py-1 border rounded",children:"Next"})]}),(0,o.jsxs)("div",{className:"text-sm",children:["Page ",y," / ",totalPages()," — ",filteredSorted().length," items"]}),o.jsx("div",{children:Array.from({length:totalPages()}).map((e,t)=>o.jsx("button",{onClick:()=>w(t+1),className:`px-2 py-1 border rounded ml-1 ${y===t+1?"bg-slate-200":""}`,children:t+1},t))})]})]})})]})}let m=(0,i.l)(s,"default"),x=(0,i.l)(s,"getStaticProps"),p=(0,i.l)(s,"getStaticPaths"),j=(0,i.l)(s,"getServerSideProps"),g=(0,i.l)(s,"config"),b=(0,i.l)(s,"reportWebVitals"),v=(0,i.l)(s,"unstable_getStaticProps"),f=(0,i.l)(s,"unstable_getStaticPaths"),S=(0,i.l)(s,"unstable_getStaticParams"),N=(0,i.l)(s,"unstable_getServerProps"),y=(0,i.l)(s,"unstable_getServerSideProps"),w=new r.PagesRouteModule({definition:{kind:l.x.PAGES,page:"/teachers",pathname:"/teachers",bundlePath:"",filename:""},components:{App:d.default,Document:c()},userland:s})},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},6689:e=>{e.exports=require("react")},6405:e=>{e.exports=require("react-dom")},997:e=>{e.exports=require("react/jsx-runtime")},7147:e=>{e.exports=require("fs")},1017:e=>{e.exports=require("path")},2781:e=>{e.exports=require("stream")},9796:e=>{e.exports=require("zlib")}};var t=require("../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),a=t.X(0,[761,199,209,450,181],()=>__webpack_exec__(5773));module.exports=a})();